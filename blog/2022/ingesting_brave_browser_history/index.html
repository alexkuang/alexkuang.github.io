
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ingesting brave browser history</title>
    <link rel="stylesheet" href="/assets/reset.css">
    <style>
      body {
        font: 16px/1.4 system-ui,Helvetica,sans-serif;
        background: #18181b;
        color: #e5e7eb;
      }
      a {
        color: #dc2626;
        text-decoration: none;
      }

      a:hover {
        color: #ef4444;
      }

      h1, h2, h3, h4, h5, h6 {
        line-height: 1.2;
        margin: 1em 0 0.5em 0;
      }

      ul {
        margin: 0 0 1rem 0;
      }

      p {
        margin: 0 0 1rem 0;
      }
    </style>
  </head>
  <body>
    <div style="display: flex; justify-content: center;">
      <div style="width: 600px;">
        <div style="display: flex; flex-direction: column;">
          <div style="margin: 0.5em 0 1em 0;">
            <a href="/"><strong>bikeshed.coffee</strong></a>
          </div>
          <main>
            <h2>ingesting brave browser history</h2>

<p>As part of shaving the &quot;build a personal google&quot; yak (longer story for another time), I wanted to extract and ingest my
browsing history into a system that I fully control.  I use Brave, but this also works for Chrome in much the same way.</p>
<p>First, the location.  On Macs this is <code>~/Library/Application Support/BraveSoftware/Brave-Browser/[Default || Profile N]/History/brave_history.sqlite</code>.
For chrome, the location is similar <code>~/Library/Application Support/BraveSoftware/Google/Chrome/[Default || Profile N]/History</code>.</p>
<p>The history is kept in a sqlite database, either <code>brave_history.sqlite</code> or <code>History</code>.  It's usually locked while the
browser process is running, but a quick hack is to make a copy of the file to a temp location to make it
read/write-able.</p>
<p>From there, the usual sqlite exploration tools work.  I recommend <code>litecli</code>, by the same folks behind the excellent
<code>pgcli</code>.  An example query to extract browsing history into denormalized rows to throw into a csv or what have you:</p>
<pre><code class="language-sql">select
  v.id,
  v.visit_time,
  u.url as url,
  u.title as url_title
from
  visits v
inner join urls u
  on v.url = u.id;
</code></pre>
<p>A quick note on <code>visit_time</code>: it is not milliseconds from unix epoch, as I had initially expected.  It's actually
<em>microseconds</em> from the <em>win32</em> epoch, which is <code>Jan 1 1601 00:00:00 UTC</code>.  To get to unix epoch millis, subtract
<code>11644473600000000</code> from <code>visit_time</code> and divide by 1000.</p>


          </main>
        </div>
      </div>
    </div>
  </body>
</html>
